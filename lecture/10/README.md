#第10回

`09`の内容をコピーして作業開始。

## 盤の状態の記憶

盤の状態はウェブページを見ればすべてわかるようになっている。ウェブページは，プログラムから見ると，DOM（Document Object Model）でできている。いちいちDOMを確認するのは面倒だから，盤の状態をJavaScriptのデータ構造を使って記憶しておくことにする。

配列を使う。配列とは，複数のデータを一列に並べて管理するデータ構造である。

盤の位置の呼び方を確認する。左上から`0`，その右が`1`・・・。

`盤面`という配列を用意して，`i`番目のマス目がマルなら`1`，バツなら`-1`を格納することにする。

```
var クリック数 = 0;
var 盤面 = [0, 0, 0, 0, 0, 0, 0, 0, 0];

function クリックへの反応(位置) {
  クリック数++;
  if (クリック数 % 2 == 1) {
    $('#セル' + 位置).addClass('○');
    盤面[位置] = 1;
  } else {
    $('#セル' + 位置).addClass('×');
    盤面[位置] = -1;
  }
  console.log(盤面);
}
```

## 勝敗の判断

ゲームのフローチャートに勝敗を判断を追加する。

### 盤面のスコア

勝ち負けという意味では，マルの勝ち，バツの勝ち，引き分け，勝負が付いていない状態の4種類がある。

+ マルの勝ち：1
+ バツの勝ち：-1
+ 引き分け：0
+ 勝負が付いていない：null

ということにする。「`null`」というのは，「値がないこと」を示す値である。

```
function 盤面のスコアを返す() {
  もしマルの勝ちなら1を返す。
  もしバツの勝ちなら-1を返す。
  もし引き分けなら0を返す。
  nullを返す。
}
```

簡単のために，1行目のみ勝敗をチェックしてみる。

マルの勝ち＝「`盤面[0]`がマル，かつ，`盤面[1]`がマル，かつ，`盤面[2]`がマル」ということ。

「AかつB」というのは`A && B`で表現する。ちなみに，「AまたはB」は`A || B`，「Aでない」は`!A`。

```
function 揃ったか() {
  if (盤面[0] == 1 && 盤面[1] == 1 && 盤面[2] == 1) {
    return 1;
  }
  return null;
}
```

`クリックへの反応`に以下を追記する。

```
var 結果 = 揃ったか();
console.log('揃った：' + 結果);
```

### 後片付け

勝敗が決まったら，勝ち筋以外の色を薄くして，そのことがわかるようにする。

`style.css`に以下を追加する。

```
.勝 {
  opacity: 1.0 !important;
}
.終 {
  opacity: 0.2;
}
```

フローチャートを書いてみる。

`クリックへの反応`に以下を追記する。

```
if (結果 == 1) {
  $('div').addClass('終');
  $('#セル0').addClass('勝');
  $('#セル1').addClass('勝');
  $('#セル2').addClass('勝');
}
```

練習：バツの勝ちにも対応する。

練習：2行目もチェックするようにする。

練習：すべてチェックするようにする。
